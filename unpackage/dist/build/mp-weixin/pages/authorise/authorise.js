(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/authorise/authorise"],{"0cfc":function(n,e,o){},"0d69":function(n,e,o){"use strict";var t,c=function(){var n=this,e=n.$createElement;n._self._c},r=[];o.d(e,"b",function(){return c}),o.d(e,"c",function(){return r}),o.d(e,"a",function(){return t})},1553:function(n,e,o){"use strict";(function(n){o("0e61"),o("921b");t(o("66fd"));var e=t(o("33da"));function t(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,o("543d")["createPage"])},"33da":function(n,e,o){"use strict";o.r(e);var t=o("0d69"),c=o("a9ea");for(var r in c)"default"!==r&&function(n){o.d(e,n,function(){return c[n]})}(r);o("71c0");var s,u=o("f0c5"),a=Object(u["a"])(c["default"],t["b"],t["c"],!1,null,"fe40af12",null,!1,t["a"],s);e["default"]=a.exports},"71c0":function(n,e,o){"use strict";var t=o("0cfc"),c=o.n(t);c.a},a9ea:function(n,e,o){"use strict";o.r(e);var t=o("f869"),c=o.n(t);for(var r in t)"default"!==r&&function(n){o.d(e,n,function(){return t[n]})}(r);e["default"]=c.a},f869:function(n,e,o){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=o("5820"),c=function(){return o.e("components/neil-modal/neil-modal").then(o.bind(null,"3a25"))},r={components:{neilModal:c},data:function(){return{background:["color1","color2","color3"],indicatorDots:!0,autoplay:!1,show2:!1,userInfo:{},show1:!0}},onLoad:function(n){console.log(n),console.log("獲取了掃碼的參數")},methods:{modalTap:function(n){this.show2=!0},cancelAuth:function(){this.show2=!1},getUserInfo:function(){var e=this;n.getUserInfo({provider:"weixin",success:function(n){console.log("getUserInfo success",n),e.userInfo=n.userInfo},fail:function(e){console.log("getUserInfo fail",e);var o=e.errMsg;~o.indexOf("uni.login")&&(o="请在登录页面完成登录操作"),n.getSetting({success:function(e){var t=e.authSetting["scope.userInfo"];t?n.showModal({title:"获取用户信息失败",content:"错误原因"+o,showCancel:!1}):n.showModal({title:"授权失败",content:"Hello uni-app需要获取您的用户信息，请在设置界面打开相关权限",success:function(e){e.confirm&&n.openSetting()}})}})}})},mpGetUserInfo:function(e){if("getUserInfo:ok"!==e.detail.errMsg)return this.show1=!1,void wx.openSetting({success:function(){wx.authorize({scope:"scope.userinfo",success:function(){o.getUserInfo()}})}});this.userInfo=e.detail.userInfo;var o=this;n.login({provider:"weixin",success:function(c){n.setStorageSync("code",c.code),o.userInfo.code=c.code,n.setStorageSync("userinfo",e.detail.userInfo),(0,t.request)({url:"/api/user/MiniProgramLogin",data:{code:o.userInfo.code,nickname:o.userInfo.nickName,headimage:o.userInfo.avatarUrl,gender:o.userInfo.gender,province:o.userInfo.province,city:o.userInfo.city,country:o.userInfo.country},method:"POST"}).then(function(e){1!=e.data.code?n.showModal({title:"登录失败",showCancel:!1}):(n.setStorageSync("token",e.data.data.userinfo.token),n.setStorageSync("login",e.data.data.userinfo),n.switchTab({url:"/pages/anchor/anchor"}))})}})}}};e.default=r}).call(this,o("543d")["default"])}},[["1553","common/runtime","common/vendor"]]]);